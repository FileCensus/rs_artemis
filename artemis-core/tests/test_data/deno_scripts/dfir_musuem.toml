system = "windows"

[output]
name = "dfir_museum"
directory = "./tmp"
format = "json"
compress = false
endpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"
collection_id = 1
output = "local"

[[artifacts]]
artifact_name = "script"
[artifacts.script]
name = "dfir_museum_test"
# This collection parses supported DFIR Musuem artifacts at C:\DFIRArtifactMuseum from multiple different Windows versions
script = "Ly8gLi4vLi4vYXJ0ZW1pcy1hcGkvc3JjL3dpbmRvd3MvZXZlbnRsb2dzLnRzCmZ1bmN0aW9uIGdldF9ldmVudGxvZ3MocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vW0Rlbm8uaW50ZXJuYWxdLmNvcmUub3BzLmdldF9ldmVudGxvZ3MocGF0aCk7CiAgY29uc3QgbG9nX2FycmF5ID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gbG9nX2FycmF5Owp9CgovLyAuLi8uLi9hcnRlbWlzLWFwaS9zcmMvd2luZG93cy9wcmVmZXRjaC50cwpmdW5jdGlvbiBnZXRfcHJlZmV0Y2hfcGF0aChwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm9bRGVuby5pbnRlcm5hbF0uY29yZS5vcHMuZ2V0X3ByZWZldGNoX3BhdGgocGF0aCk7CiAgY29uc3QgcGYgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBwZjsKfQoKLy8gLi4vLi4vYXJ0ZW1pcy1hcGkvc3JjL3dpbmRvd3MvcmVnaXN0cnkudHMKZnVuY3Rpb24gZ2V0X3JlZ2lzdHJ5KHBhdGgpIHsKICBjb25zdCBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfcmVnaXN0cnkocGF0aCk7CiAgY29uc3QgcmVnX2FycmF5ID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcmVnX2FycmF5Owp9CgovLyAuLi8uLi9hcnRlbWlzLWFwaS9zcmMvd2luZG93cy9zaG9ydGN1dHMudHMKZnVuY3Rpb24gZ2V0X2xua19maWxlKHBhdGgpIHsKICBjb25zdCBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfbG5rX2ZpbGUocGF0aCk7CiAgY29uc3QgbG5rID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gbG5rOwp9CgovLyAuLi8uLi9hcnRlbWlzLWFwaS9zcmMvd2luZG93cy9zcnVtLnRzCmZ1bmN0aW9uIGdldF9zcnVtX2FwcGxpY2F0aW9uX2luZm8ocGF0aCkgewogIGNvbnN0IG5hbWUgPSAie0QxMENBMkZFLTZGQ0YtNEY2RC04NDhFLUIyRTk5MjY2RkE4OX0iOwogIGNvbnN0IGRhdGEgPSBEZW5vW0Rlbm8uaW50ZXJuYWxdLmNvcmUub3BzLmdldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHNydW0gPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBzcnVtOwp9CmZ1bmN0aW9uIGdldF9zcnVtX2FwcGxpY2F0aW9uX3RpbWVsaW5lKHBhdGgpIHsKICBjb25zdCBuYW1lID0gIns1QzhDRjFDNy03MjU3LTRGMTMtQjIyMy05NzBFRjU5MzkzMTJ9IjsKICBjb25zdCBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfc3J1bShwYXRoLCBuYW1lKTsKICBjb25zdCBzcnVtID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gc3J1bTsKfQpmdW5jdGlvbiBnZXRfc3J1bV9hcHBsaWNhdGlvbl92ZnUocGF0aCkgewogIGNvbnN0IG5hbWUgPSAiezdBQ0JCQUEzLUQwMjktNEJFNC05QTdBLTA4ODU5MjdGMUQ4Rn0iOwogIGNvbnN0IGRhdGEgPSBEZW5vW0Rlbm8uaW50ZXJuYWxdLmNvcmUub3BzLmdldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHNydW0gPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBzcnVtOwp9CmZ1bmN0aW9uIGdldF9zcnVtX2VuZXJneV9pbmZvKHBhdGgpIHsKICBjb25zdCBuYW1lID0gIntEQTczRkI4OS0yQkVBLTREREMtODZCOC02RTA0OEM2REE0Nzd9IjsKICBjb25zdCBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfc3J1bShwYXRoLCBuYW1lKTsKICBjb25zdCBzcnVtID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gc3J1bTsKfQpmdW5jdGlvbiBnZXRfc3J1bV9lbmVyZ3lfdXNhZ2UocGF0aCkgewogIGxldCBuYW1lID0gIntGRUU0RTE0Ri0wMkE5LTQ1NTAtQjVDRS01RkEyREEyMDJFMzd9IjsKICBsZXQgZGF0YSA9IERlbm9bRGVuby5pbnRlcm5hbF0uY29yZS5vcHMuZ2V0X3NydW0ocGF0aCwgbmFtZSk7CiAgY29uc3Qgc3J1bSA9IEpTT04ucGFyc2UoZGF0YSk7CiAgbmFtZSA9ICJ7RkVFNEUxNEYtMDJBOS00NTUwLUI1Q0UtNUZBMkRBMjAyRTM3fUxUIjsKICBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfc3J1bShwYXRoLCBuYW1lKTsKICBjb25zdCBzcnVtX2FsbCA9IHNydW0uY29uY2F0KEpTT04ucGFyc2UoZGF0YSkpOwogIHJldHVybiBzcnVtX2FsbDsKfQpmdW5jdGlvbiBnZXRfc3J1bV9uZXR3b3JrX2luZm8ocGF0aCkgewogIGNvbnN0IG5hbWUgPSAiezk3M0Y1RDVDLTFEOTAtNDk0NC1CRThFLTI0Qjk0MjMxQTE3NH0iOwogIGNvbnN0IGRhdGEgPSBEZW5vW0Rlbm8uaW50ZXJuYWxdLmNvcmUub3BzLmdldF9zcnVtKHBhdGgsIG5hbWUpOwogIGNvbnN0IHNydW0gPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBzcnVtOwp9CmZ1bmN0aW9uIGdldF9zcnVtX25ldHdvcmtfY29ubmVjdGl2aXR5KHBhdGgpIHsKICBjb25zdCBuYW1lID0gIntERDY2MzZDNC04OTI5LTQ2ODMtOTc0RS0yMkMwNDZBNDM3NjN9IjsKICBjb25zdCBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfc3J1bShwYXRoLCBuYW1lKTsKICBjb25zdCBzcnVtID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gc3J1bTsKfQpmdW5jdGlvbiBnZXRfc3J1bV9ub3RpZmljYXRpb25zKHBhdGgpIHsKICBjb25zdCBuYW1lID0gIntEMTBDQTJGRS02RkNGLTRGNkQtODQ4RS1CMkU5OTI2NkZBODZ9IjsKICBjb25zdCBkYXRhID0gRGVub1tEZW5vLmludGVybmFsXS5jb3JlLm9wcy5nZXRfc3J1bShwYXRoLCBuYW1lKTsKICBjb25zdCBzcnVtID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gc3J1bTsKfQoKLy8gLi4vLi4vYXJ0ZW1pcy1hcGkvbW9kLnRzCmZ1bmN0aW9uIGdldExua0ZpbGUocGF0aCkgewogIHJldHVybiBnZXRfbG5rX2ZpbGUocGF0aCk7Cn0KZnVuY3Rpb24gZ2V0RXZlbnRMb2dzKHBhdGgpIHsKICByZXR1cm4gZ2V0X2V2ZW50bG9ncyhwYXRoKTsKfQpmdW5jdGlvbiBnZXRSZWdpc3RyeShwYXRoKSB7CiAgcmV0dXJuIGdldF9yZWdpc3RyeShwYXRoKTsKfQpmdW5jdGlvbiBnZXRQcmVmZXRjaFBhdGgocGF0aCkgewogIHJldHVybiBnZXRfcHJlZmV0Y2hfcGF0aChwYXRoKTsKfQpmdW5jdGlvbiBnZXRTcnVtQXBwbGljYXRpb25JbmZvKHBhdGgpIHsKICByZXR1cm4gZ2V0X3NydW1fYXBwbGljYXRpb25faW5mbyhwYXRoKTsKfQpmdW5jdGlvbiBnZXRTcnVtQXBwbGljYXRpb25UaW1lbGluZShwYXRoKSB7CiAgcmV0dXJuIGdldF9zcnVtX2FwcGxpY2F0aW9uX3RpbWVsaW5lKHBhdGgpOwp9CmZ1bmN0aW9uIGdldFNydW1BcHBsaWNhdGlvblZGVShwYXRoKSB7CiAgcmV0dXJuIGdldF9zcnVtX2FwcGxpY2F0aW9uX3ZmdShwYXRoKTsKfQpmdW5jdGlvbiBnZXRTcnVtRW5lcmd5SW5mbyhwYXRoKSB7CiAgcmV0dXJuIGdldF9zcnVtX2VuZXJneV9pbmZvKHBhdGgpOwp9CmZ1bmN0aW9uIGdldFNydW1FbmVyZ3lVc2FnZShwYXRoKSB7CiAgcmV0dXJuIGdldF9zcnVtX2VuZXJneV91c2FnZShwYXRoKTsKfQpmdW5jdGlvbiBnZXRTcnVtTmV0d29ya0luZm8ocGF0aCkgewogIHJldHVybiBnZXRfc3J1bV9uZXR3b3JrX2luZm8ocGF0aCk7Cn0KZnVuY3Rpb24gZ2V0U3J1bUNvbm5lY3Rpdml0eShwYXRoKSB7CiAgcmV0dXJuIGdldF9zcnVtX25ldHdvcmtfY29ubmVjdGl2aXR5KHBhdGgpOwp9CmZ1bmN0aW9uIGdldFNydW1Ob3RpZmljYXRpb25zKHBhdGgpIHsKICByZXR1cm4gZ2V0X3NydW1fbm90aWZpY2F0aW9ucyhwYXRoKTsKfQoKLy8gbWFpbi50cwp2YXIgc3RhcnRfcGF0aCA9ICJDOlxcREZJUkFydGlmYWN0TXVzZXVtIjsKZnVuY3Rpb24gbWFpbigpIHsKICBjb25zdCBhbWNhY2hlcyA9IGJ1bGtBbWNhY2hlVGVzdHMoKTsKICBjb25zdCBzaG9ydGN1dHMgPSBidWxrU2hvcnRjdXRzKCk7CiAgY29uc3QgcHJlZmV0Y2hzID0gYnVsa1ByZWZldGNoKCk7CiAgY29uc3QgbG9ncyA9IGJ1bGtFdmVudGxvZ3MoKTsKICBjb25zdCBzcnVtcyA9IGJ1bGtTUlVNKCk7CiAgY29uc3QgcmVnaXN0cnlzID0gYnVsa1JlZ2lzdHJ5KCk7CiAgY29uc3QgcmVzdWx0cyA9IHsKICAgIGFtY2FjaGVzLAogICAgc2hvcnRjdXRzLAogICAgcHJlZmV0Y2hzLAogICAgbG9ncywKICAgIHNydW1zLAogICAgcmVnaXN0cnlzCiAgfTsKICByZXR1cm4gcmVzdWx0czsKfQpmdW5jdGlvbiBidWxrQW1jYWNoZVRlc3RzKCkgewogIGNvbnN0IGFtY2FjaGVzID0gW107CiAgY29uc3QgcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcQW1jYWNoZVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxBbWNhY2hlLmh2ZWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcQW1jYWNoZVxcV2luMTBcXFJhdGhidW5WTVxcQW1jYWNoZS5odmVgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXEFtY2FjaGVcXFdpbjExXFxSYXRoYnVuVk1cXEFtY2FjaGUuaHZlYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxBbWNhY2hlXFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuXFxBbWNhY2hlLmh2ZWAKICBdOwogIGZvciAoY29uc3QgZW50cnkgb2YgcGF0aHMpIHsKICAgIGNvbnNvbGUubG9nKGBQYXJzaW5nIEFtY2FjaGUgJHtlbnRyeX1gKTsKICAgIGNvbnN0IHJlc3VsdCA9IGdldFJlZ2lzdHJ5KGVudHJ5KTsKICAgIGFtY2FjaGVzLnB1c2gocmVzdWx0KTsKICB9CiAgcmV0dXJuIGFtY2FjaGVzOwp9CmZ1bmN0aW9uIGJ1bGtTaG9ydGN1dHMoKSB7CiAgY29uc3Qgc2hvcnRjdXRzID0gW107CiAgY29uc3QgcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcTE5LXFxXaW43YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxMTktcXFdpbjguMGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcTE5LXFxXaW44LjFgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXExOS1xcV2luMTBgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXExOS1xcV2luMTFcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcTE5LXFxXaW4yMDEyYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxMTktcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXExOS1xcV2luMjAxMlIyXFxFcmljWmltbWVybWFuYAogIF07CiAgZm9yIChjb25zdCBlbnRyeSBvZiBwYXRocykgewogICAgZm9yIChjb25zdCBmaWxlIG9mIERlbm8ucmVhZERpclN5bmMoZW50cnkpKSB7CiAgICAgIGNvbnN0IGxua19maWxlID0gYCR7ZW50cnl9XFwke2ZpbGUubmFtZX1gOwogICAgICBjb25zb2xlLmxvZyhgUGFyc2luZyBTaG9ydGN1dCAke2xua19maWxlfWApOwogICAgICBjb25zdCByZXN1bHQgPSBnZXRMbmtGaWxlKGxua19maWxlKTsKICAgICAgc2hvcnRjdXRzLnB1c2gocmVzdWx0KTsKICAgIH0KICB9CiAgcmV0dXJuIHNob3J0Y3V0czsKfQpmdW5jdGlvbiBidWxrUHJlZmV0Y2goKSB7CiAgY29uc3QgcHJlZmV0Y2hzID0gW107CiAgY29uc3QgcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjdcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjhcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjdTUDFcXFJhdGhidW5WTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjEwXFxBUFRTaW11bGF0b3JWTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUHJlZmV0Y2hcXFdpbjEwXFxSYXRoYnVuVk1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFByZWZldGNoXFxXaW4xMVxcUmF0aGJ1blZNXFxDb21wcmVzc2VkYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxQcmVmZXRjaFxcV2luODFOb1VwZGF0ZVxcUmF0aGJ1blZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxQcmVmZXRjaFxcV2luODFVcGRhdGVcXFJhdGhidW5WTWAKICBdOwogIGZvciAoY29uc3QgZW50cnkgb2YgcGF0aHMpIHsKICAgIGNvbnNvbGUubG9nKGBQYXJzaW5nIFByZWZldGNoIGRpcmVjdG9yeSAke2VudHJ5fWApOwogICAgY29uc3QgcmVzdWx0ID0gZ2V0UHJlZmV0Y2hQYXRoKGVudHJ5KTsKICAgIHByZWZldGNocy5wdXNoKHJlc3VsdCk7CiAgfQogIHJldHVybiBwcmVmZXRjaHM7Cn0KZnVuY3Rpb24gYnVsa0V2ZW50bG9ncygpIHsKICBjb25zdCBsb2dzID0gW107CiAgY29uc3QgcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcRXZlbnRMb2dzXFxXaW4xMFxcUmF0aGJ1blZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxFdmVudExvZ3NcXFdpbjEwXFxBUFRTaW11bGF0b3JWTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcRXZlbnRMb2dzXFxXaW4xMFxcQmVsa2Fzb2Z0Q1RGX0luc2lkZXJUaHJlYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXEV2ZW50TG9nc1xcV2luMTBcXEFQVFNpbXVsYXRvclZNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxFdmVudExvZ3NcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcRXZlbnRMb2dzXFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxFdmVudExvZ3NcXFdpbjExXFxSYXRoYnVuVk1gCiAgXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHBhdGhzKSB7CiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgRGVuby5yZWFkRGlyU3luYyhlbnRyeSkpIHsKICAgICAgaWYgKCFmaWxlLm5hbWUuaW5jbHVkZXMoImV2dHgiKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGNvbnN0IGxvZ19maWxlID0gYCR7ZW50cnl9XFwke2ZpbGUubmFtZX1gOwogICAgICBjb25zb2xlLmxvZyhgUGFyc2luZyBFdmVudExvZ3MgZGlyZWN0b3J5ICR7bG9nX2ZpbGV9YCk7CiAgICAgIGNvbnN0IHJlc3VsdCA9IGdldEV2ZW50TG9ncyhsb2dfZmlsZSk7CiAgICAgIGxvZ3MucHVzaChyZXN1bHQpOwogICAgfQogIH0KICByZXR1cm4gbG9nczsKfQpmdW5jdGlvbiBidWxrU1JVTSgpIHsKICBjb25zdCBzcnVtcyA9IHsKICAgIGFwcGluZm86IFtdLAogICAgdGltZWxpbmU6IFtdLAogICAgbmV0aW5mbzogW10sCiAgICBjb25uZWN0OiBbXSwKICAgIG5vdGlmczogW10sCiAgICBlbmVyZ3k6IFtdLAogICAgZW5lcmd5aW5mbzogW10sCiAgICB2ZnU6IFtdCiAgfTsKICBjb25zdCBwYXRocyA9IFsKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxTUlVNXFxXaW4xMFxcUmF0aGJ1blZNXFxDbGVhblxcU1JVREIuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxTUlVNXFxXaW4xMFxcUmF0aGJ1blZNXFxEaXJ0eVxcU1JVREIuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxTUlVNXFxXaW4xMFxcQVBUU2ltdWxhdG9yVk1cXENsZWFuXFxTUlVEQi5kYXRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFNSVU1cXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcQ2xlYW5cXFNSVURCLmRhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcU1JVTVxcV2luMTBcXEJlbGthc29mdENURl9JbnNpZGVyVGhyZWF0XFxEaXJ0eVxcU1JVREIuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxTUlVNXFxXaW4xMVxcUmF0aGJ1blZNXFxDbGVhblxcU1JVREIuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxTUlVNXFxXaW4xMVxcUmF0aGJ1blZNXFxEaXJ0eVxcU1JVREIuZGF0YAogIF07CiAgZm9yIChjb25zdCBlbnRyeSBvZiBwYXRocykgewogICAgY29uc29sZS5sb2coYFBhcnNpbmcgU1JVTSAke2VudHJ5fWApOwogICAgc3J1bXMuYXBwaW5mby5wdXNoKGdldFNydW1BcHBsaWNhdGlvbkluZm8oZW50cnkpKTsKICAgIHNydW1zLmNvbm5lY3QucHVzaChnZXRTcnVtQ29ubmVjdGl2aXR5KGVudHJ5KSk7CiAgICBzcnVtcy5lbmVyZ3kucHVzaChnZXRTcnVtRW5lcmd5VXNhZ2UoZW50cnkpKTsKICAgIHNydW1zLmVuZXJneWluZm8ucHVzaChnZXRTcnVtRW5lcmd5SW5mbyhlbnRyeSkpOwogICAgc3J1bXMubm90aWZzLnB1c2goZ2V0U3J1bU5vdGlmaWNhdGlvbnMoZW50cnkpKTsKICAgIHNydW1zLm5ldGluZm8ucHVzaChnZXRTcnVtTmV0d29ya0luZm8oZW50cnkpKTsKICAgIHNydW1zLnZmdS5wdXNoKGdldFNydW1BcHBsaWNhdGlvblZGVShlbnRyeSkpOwogICAgc3J1bXMudGltZWxpbmUucHVzaChnZXRTcnVtQXBwbGljYXRpb25UaW1lbGluZShlbnRyeSkpOwogIH0KICByZXR1cm4gc3J1bXM7Cn0KZnVuY3Rpb24gYnVsa1JlZ2lzdHJ5KCkgewogIGNvbnN0IHJlZ3MgPSBbXTsKICBjb25zdCBwYXRocyA9IFsKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxTQU1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcQVBUU2ltdWxhdG9yVk1cXFNPRlRXQVJFYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxTWVNURU1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcQVBUU2ltdWxhdG9yVk1cXFNFQ1VSSVRZYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxERUZBVUxUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEFQVFNpbXVsYXRvclZNXFxUZXN0VXNlclxcTlRVU0VSLkRBVGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxBUFRTaW11bGF0b3JWTVxcVGVzdFVzZXJcXFVzckNsYXNzLmRhdGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcU0FNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEJlbGthc29mdENURl9JbnNpZGVyVGhyZWF0XFxTT0ZUV0FSRWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcU1lTVEVNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXEJlbGthc29mdENURl9JbnNpZGVyVGhyZWF0XFxTRUNVUklUWWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxCZWxrYXNvZnRDVEZfSW5zaWRlclRocmVhdFxcREVGQVVMVGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXFNBTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXFNPRlRXQVJFYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcU1lTVEVNYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcU0VDVVJJVFlgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxERUZBVUxUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcQ09NUE9ORU5UU2AsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXEJCSWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXEVMQU1gLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxCQ0QtVGVtcGxhdGVgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxOVFVTRVIuREFUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcVXNyQ2xhc3MuZGF0YCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMTBcXFJhdGhidW5WTVxcRFJJVkVSU2AsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjEwXFxSYXRoYnVuVk1cXERFRkFVTFQgKE5UVVNFUilcXE5UVVNFUi5EQVRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxMb2NhbFNlcnZpY2VcXE5UVVNFUi5EQVRgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4xMFxcUmF0aGJ1blZNXFxOZXR3b3JrU2VydmljZVxcTlRVU0VSLkRBVGAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXFNBTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXFNZU1RFTWAsCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjIwMTJSMlxcU3RvbGVuU3plY2h1YW5cXFNPRlRXQVJFYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMjAxMlIyXFxTdG9sZW5TemVjaHVhblxcU0VDVVJJVFlgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuXFxCQklgLAogICAgYCR7c3RhcnRfcGF0aH1cXFdpbmRvd3NcXFJlZ2lzdHJ5XFxXaW4yMDEyUjJcXFN0b2xlblN6ZWNodWFuXFxERUZBVUxUYCwKICAgIGAke3N0YXJ0X3BhdGh9XFxXaW5kb3dzXFxSZWdpc3RyeVxcV2luMjAxMlIyXFxTdG9sZW5TemVjaHVhblxcRFJJVkVSU2AKICBdOwogIGZvciAoY29uc3QgZW50cnkgb2YgcGF0aHMpIHsKICAgIGNvbnNvbGUubG9nKGBQYXJzaW5nIFJlZ2lzdHJ5IGZpbGUgJHtlbnRyeX1gKTsKICAgIGNvbnN0IHJlc3VsdCA9IGdldFJlZ2lzdHJ5KGVudHJ5KTsKICAgIHJlZ3MucHVzaChyZXN1bHQpOwogIH0KICBjb25zdCB6aW1fcGF0aHMgPSBbCiAgICBgJHtzdGFydF9wYXRofVxcV2luZG93c1xcUmVnaXN0cnlcXFdpbjdcXEVyaWNaaW1tZXJtYW5gCiAgXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIHppbV9wYXRocykgewogICAgZm9yIChjb25zdCBmaWxlIG9mIERlbm8ucmVhZERpclN5bmMoZW50cnkpKSB7CiAgICAgIGNvbnN0IHJlZ19maWxlID0gYCR7ZW50cnl9XFwke2ZpbGUubmFtZX1gOwogICAgICBjb25zb2xlLmxvZyhgUGFyc2luZyBaaW1tZXJtYW4gUmVnIGZpbGUgJHtyZWdfZmlsZX1gKTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXN1bHQgPSBnZXRSZWdpc3RyeShyZWdfZmlsZSk7CiAgICAgICAgcmVncy5wdXNoKHJlc3VsdCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gcGFyc2UgJHtyZWdfZmlsZX0gZXJyb3I6ICR7ZX1gKTsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gcmVnczsKfQptYWluKCk7Cg=="
